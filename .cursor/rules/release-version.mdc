---
description: 发布与版本号规范
globs: 
alwaysApply: true
---

# 发布必须带版本号

- **发布需用户同意**：不得在未得到用户明确同意前执行 `git commit` 或 `git push`。应先给出本次发布的版本号、提交信息与将改动的文件/内容，等用户确认（如回复「同意」「发布」「可以」等）后再执行提交与推送。
- 当用户要求「发布」「发版」「发布 git」「release」或类似操作时，**必须先更新版本号再提交和推送**。
- 版本号来源：本项目的 `package.json` 中的 `version` 字段（当前为语义化版本，如 1.0.31）。
- 操作顺序：
  1. 根据改动类型决定版本号：小改动/修复 → patch（第三位 +1）；新功能 → minor（第二位 +1，第三位归 0）；不兼容大改 → major（第一位 +1，后两位归 0）。
  2. 修改 `package.json` 里的 `version`。
  3. 执行 `git add`、`git commit`（提交信息中必须包含版本号，例如 `chore: release v1.0.32` 或 `feat: xxx (v1.0.32)`）、`git push`。
- 若项目中有 `scripts/release.ps1` 或类似发布脚本，优先按脚本逻辑处理版本号与打 tag，但提交/推送时仍须在信息中体现版本号。
